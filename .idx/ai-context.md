# ðŸ¤– PROJECT CONTEXT & RULES (GestÃ£o Pro)

## 1. TECH STACK
- **Frontend:** React + Vite + TypeScript
- **Styling:** Tailwind CSS (Dark Mode default)
- **Backend/DB:** Supabase (PostgreSQL)
- **State/Logic:** "Frontend First" architecture (Logic in `src/domain`)

## 2. CRITICAL RULES (DO NOT BREAK)
1.  **UUIDs ONLY:** Never use integer IDs (1, 2, 3). All entities use `uuid` generated by Supabase (`gen_random_uuid()`).
2.  **DATA SANITIZATION:**
    - **INPUT:** Before saving to Supabase, ALWAYS use `toSupabaseFormat(data, table)` from `@/utils/dataSanitizer`.
    - **OUTPUT:** When reading from Supabase, ALWAYS use `normalize[Entity](data)` from `@/utils/dataSanitizer`.
    - *Reason:* Fixing the conflict between UI (camelCase/PT) and DB (snake_case/EN).
3.  **SINGLETON SUPABASE:** Never create a new `createClient`. Always import `{ supabase }` from `@/services/supabaseClient`.
4.  **ROBUST AUTH:** The client is configured with `persistSession: true`. Do not override.

## 3. FILE STRUCTURE
- `src/domain/*`: Business logic, pricing rules, repositories. (The "Brain").
- `src/utils/dataSanitizer.ts`: The universal translator/cleaner.
- `src/services/supabaseClient.ts`: The only DB connection point.
- `src/_LEGADO`: Deprecated code (reference only, do not import from here).

## 4. CODING STYLE
- **UI Language:** Portuguese (PT-BR).
- **Code Language:** English (variables, functions) is preferred, but legacy PT variables must be normalized via Sanitizer.
- **UX:** Premium, card-based layout, dark mode by default.

## 5. COMMON PITFALLS TO AVOID
- Do not invent columns that don't exist (e.g., `active` is now fixed, but check DB schema first).
- Do not mix up `deposit_id` (DB) with `depositoId` (Frontend). Use the Sanitizer!